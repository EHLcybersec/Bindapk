




















































































































































































































































































































































































































































import os
import sys
import re

mainapk = "$apk"
filemanifest = "Payload/AndroidManifest.xml"
fhandle = open(filemanifest,'r')
fread = fhandle.readlines()
prmns = []
for line in fread:
		if('<uses-permission' in line):
			prmns.append(line.replace('\n',''))
fhandle.close()
filemanifest = "Original/AndroidManifest.xml"
fhandle = open(filemanifest,'r')
fread = fhandle.readlines()
half=[]
for line in fread:
		if('<uses-permission' in line):
			prmns.append(line.replace('\n',''))
		else:
			half.append(line)
prmns = set(prmns)
fhandle.close()
fhandle = open(filemanifest,'w')
for i in half:
		if half.index(i)==2:
			for j in prmns:
				fhandle.write(j+"\n")
		else:
			fhandle.write(i)
for i in prmns:
		print('\t',i.split('android:name="')[1].split('"')[0])
print(("\033[92m[+]\033[0m %d Permissions added."%(len(prmns))))


